
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>人员交接</title>
    <style>
        body { font-family: Arial; padding: 20px; max-width: 500px; margin: 0 auto; }
        .form-group { margin-bottom: 15px; }
        .form-row { display: flex; align-items: center; margin-bottom: 10px; }
        label { min-width: 80px; }
        input { padding: 8px; border: 1px solid #ddd; border-radius: 3px; }
        button { 
            padding: 8px 20px; 
            background-color: #4CAF50; 
            color: white; 
            border: none; 
            border-radius: 3px; 
            cursor: pointer; 
        }
        button:hover { background-color: #45a049; }
        .arrow { margin: 0 10px; font-size: 18px; }
        .time-display { color: #666; font-size: 14px; margin-top: 5px; }
    </style>
</head>
<body>
    <h2>人员交接</h2>
    
    <div class="form-group">
        <label>文件:</label>
        <div id="fileDisplay" style="font-weight:bold;"></div>
    </div>
    
    <div class="form-row">
        <label for="sender">本人:</label>
        <input type="text" id="sender" style="width:120px;">
        <span class="arrow">→</span>
        <label for="receiver">接收人:</label>
        <input type="text" id="receiver" style="width:120px;">
    </div>
    
    <div class="form-group">
        <div class="time-display" id="timeDisplay"></div>
    </div>
    
    <button onclick="submitForm()">提交</button>

    <script>
        // 解析URL参数
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                file: decodeURIComponent(params.get('file') || '未指定文件'),
                personnel: (params.get('personnel') || '').split(',')
            };
        }

        // 初始化页面
        function init() {
            const params = getUrlParams();
            document.getElementById('fileDisplay').textContent = params.file;
            
            // 显示当前时间
            updateTimeDisplay();
            setInterval(updateTimeDisplay, 1000);
            
            // 自动填充第一个人员作为默认发送人
            if(params.personnel.length > 0) {
                document.getElementById('sender').value = params.personnel[0];
            }
        }

        // 更新时间显示
        function updateTimeDisplay() {
            const now = new Date();
            document.getElementById('timeDisplay').textContent = 
                "提交时间: " + now.toLocaleString('zh-CN', { 
                    year: 'numeric', 
                    month: '2-digit', 
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                }).replace(/\//g, '-');
        }

        // 提交表单
        function submitForm() {
            const sender = document.getElementById('sender').value.trim();
            const receiver = document.getElementById('receiver').value.trim();
            const file = getUrlParams().file;
            const time = document.getElementById('timeDisplay').textContent.replace('提交时间: ', '');
            
            if(!sender || !receiver) {
                alert('请填写本人和接收人信息');
                return;
            }
            
            // 构造邮件内容
            const subject = `人员交接确认: ${file}`;
            const body = `文件: ${file}\n时间: ${time}\n交接: ${sender} → ${receiver}`;
            
            // 发送邮件
            window.location.href = `mailto:lium@porite.com.cn?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        }

        // 页面加载时初始化
        window.onload = init;
    </script>
</body>
</html>
